version: "0.0.1"


def:
  arg:
    arg1: "123"
    arg2: [ "a", "b", "c" ]

stage:
  g1:
    step:
      s1:
        exec:
          action: nop
        then:
          - reg:
              s3_loop_idx: 0
      
      s3:
        let:
          arg2:
            $ref: def.arg.arg2
        exec:
          action: echo
          args:
            echo:
              - hello
              - hello: world
              - $ref: arg2
        
        assert: |
          (all
              (eq value.0 "hello")
              (eq value.1.hello "world")
              (eq value.2.1 "b")
          )
      
      s4:
        let:
          s3_loop_idx:
            $num: "{{reg.s3_loop_idx}}"
        exec:
          action: nop
        then:
          - if: (lt s3_loop_idx 3)
            reg:
              s3_loop_idx:
                $num: "{{num_add s3_loop_idx 1}}"
            goto: s3
            
            
              
        
      
     

